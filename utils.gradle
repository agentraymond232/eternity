def load(String path) {
  Properties properties = new Properties()
  file(path).withInputStream { stream ->
    properties.load(stream)
  }
  return properties;
}

def gitHash = { ->
  def stdout = new ByteArrayOutputStream()
  exec {
    commandLine 'git', 'rev-parse', '--short', 'HEAD'
    standardOutput = stdout
  }
  return stdout.toString().trim()
}

def gitTag = { ->
  def stdout = new ByteArrayOutputStream()
  exec {
    commandLine 'git', 'describe', '--tags'
    standardOutput = stdout
  }
  return stdout.toString().trim()
}

def versionCode(String path) {
  return load(path)['version.code']
}

def versionName(String path) {
  return load(path)['version.name']
}

ext {
  load = this.&load

  gitHash = this.&gitHash
  gitTag = this.&gitTag

  versionCode = this.&versionCode
  versionName = this.&versionName
}
